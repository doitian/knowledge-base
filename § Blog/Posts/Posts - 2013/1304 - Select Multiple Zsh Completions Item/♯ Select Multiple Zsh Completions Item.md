---
date: '2013-04-08'
description: I like the feature to Insert all completions in bash, and I can get this feature in zsh now
summary: I like the feature to Insert all completions in bash, and I can get this feature in zsh now
lastmod: '2017-01-19'
title: Select multiple zsh completions item
---

# Select Multiple Zsh Completions Item

#zsh #console

``` zsh
# ^Xa to insert all matches
zle -C all-matches complete-word _generic
bindkey '^Xa' all-matches
zstyle ':completion:all-matches:*' old-matches only
zstyle ':completion:all-matches::::' completer _all_matches
```

> UPDATE: The snippet above brings `insert-completions` to zsh. Thanks, Trevor Joynson, who has provided the solution in [comment](#comment-2754013033).

Command `insert-completions` (see [man bash](http://linux.die.net/man/1/bash)) is the
feature I most miss in bash.

> [insert-completions] Insert all completions of the text before point that would have been
> generated by possible-completions.

Its default binding is <kbd>M-*</kbd>, a.k.a, <kbd>Alt-Shift-8</kbd> or
<kbd>Meta-Shift-8</kbd>.

It is useful for simple batch operations, such as removing all git branches
starting with `feature/`.

After I switched to zsh, I have been looking for a similar command, but for
no results. However, I just discovered the zsh way to select multiple
completions recently, using `accept-and-hold` (see
[man zshzle](http://linux.die.net/man/1/zshzle)).

> [accept-and-hold] Push the contents of the buffer on the buffer stack and
> execute it.

The default binding is <kbd>M-a</kbd> (a.k.a, <kbd>Alt-a</kbd> or
<kbd>Meta-a</kbd>). If the command line has input content `ls`, <kbd>M-a</kbd>
executes the line `ls` without clearing the input.

It seems unrelated. But if completion menu is activated and a menu item is
selected (the simplest way is <kbd>Tab</kbd> twice), `accept-and-hold` accepts
the current menu item without closing completing menu. So it is possible to
select multiple items by navigating to wanted items, and type <kbd>M-a</kbd>
to select them.

## Bash Sample to delete git branches ##

1.  First enter following text.

        $ git branch -D feature/

2.  Type <kbd>Tab</kbd> to activate completion.

        $ git branch -D feature/
        feature/a feature/b

3.  Type <kbd>M-*</kbd> to insert all completions.

        $ git branch -D feature/a feature/b

4.   Review, delete branches should be keep.

5.   Type <kbd>Enter</kbd> to execute the line.

## Zsh way ##

1.  First enter following text.

        $ git branch -D feature/

2.  Type <kbd>Tab</kbd> to activate completion.

        $ git branch -D feature/
        feature/a feature/b

3.  Type <kbd>Tab</kbd> again, to select first item. Brackets demonstrate
    which item is currently selected.

        $ git branch -D feature/a
        [feature/a] feature/b

4.  Type <kbd>M-a</kbd> to keep selected item and continue completing

        $ git branch -D feature/a feature/b 
        feature/a [feature/b]

5.  Use <kbd>Tab</kbd> to skip branches that should be keep. The item selection
    mode also supports <kbd>C-n</kbd>, <kbd>C-p</kbd>, <kbd>C-f</kbd>,
    <kbd>C-b</kbd> to move around, and <kbd>C-s</kbd>, <kbd>C-r</kbd> to
    search.

6.  When cursor is on the last branch to be deleted, type <kbd>Enter</kbd> to
    accept it and stop completion. If <kbd>M-a</kbd> is typed by accident, you
    have to delete the last inserted completion item, because zsh auto inserts
    current selected item. 

## Discover zsh commands ##

The builtin `bindkey` lists all commands with key-bindings. They are most
frequently used commands, that's why they deserve a key-binding.

The commands reference can be looked up in `man zshzle`. I also discovered
several other interesting key-bindings:

-   `M-h` Run `man` on current entered command. Say you are editing `tcpdump`
    options, and want to check manual without losing the input.
-   `M-?` Run `which-command` on current entered command.
